
rm(list=ls())

# PORTAL DE DATOS ABIERTOS DEL MINISTERIO DE ECONOMÍA Y FINANZAS DEL PERÚ 
# https://datosabiertos.mef.gob.pe/dataset?q=inversi&page=1&sort=nameasce

library(dplyr)
library(arrow)
ruta <- 
   c('https://fs.datosabiertos.mef.gob.pe/datastorefiles/CIERRE_INVERSIONES.csv'
    ,'https://fs.datosabiertos.mef.gob.pe/datastorefiles/DETALLE_INVERSIONES.csv'
    ,'https://fs.datosabiertos.mef.gob.pe/datastorefiles/ESTADO_SITUACIONAL.csv'
    ,'https://fs.datosabiertos.mef.gob.pe/datastorefiles/FORMATO_12B.csv'
    ,'https://fs.datosabiertos.mef.gob.pe/datastorefiles/INVERSIONES_BRECHAS.csv'
    ,'https://fs.datosabiertos.mef.gob.pe/datastorefiles/INVERSIONES_DESACTIVADAS.csv'
    ,'https://fs.datosabiertos.mef.gob.pe/datastorefiles/PROCESO_SELECCION.csv')

import_file <- function(link) {
  setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
  # Variables categorizadas
  CADENAS   <- c( "ACCIONES", "ALTERNATIVA", "COD_SNIP", "COD_UNICO", "CODIGO_SNIP", "CODIGO_UNICO","DEPARTAMENTO", "DES_BRECHA"
                 , "DES_CIERRE", "DES_MODALIDAD", "DES_SERVICIO","DES_TIPOLOGIA", "DES_UM", "DESCRIPCION", "DISTRITO", "ENTIDAD"
                 , "ESPACIO_GEOGRAFICO","ESTADO", "FACTOR", "FUNCION", "MARCO", "NIVEL", "NOM_OPMI", "NOM_UEI", "NOM_UEP","NOM_UF"
                 , "NOMBRE_INVERSION", "NOMBRE_OPMI", "NOMBRE_UEI", "NOMBRE_UEP", "NOMBRE_UF","OPI", "PERIODO", "PRODUCTO", "PROGRAMA"
                 , "PROVINCIA", "RESP_NOMBRE_UF","RESPONSABLE_OPI", "RESPONSABLE_OPMI", "RESPONSABLE_UEI", "SEC_EJEC", "SECTOR"
                 , "SITUACION", "SUBPROGRAM", "SUBPROGRAMA", "TIPO", "TIPO_INVERSION", "UBIGEO","ULT_PERIODO_REG_F12B", "ULTIMO_DEVENGADO"
                 ,"ETAPA_F8", "ETAPA_F9")
  
  FECHAS    <- c("FEC_CIERRE", "FEC_FIN_EJEC_FISICA", "FEC_FIN_EJECUCION", "FEC_INI_EJEC_FISICA","FEC_INI_EJECUCION", "FEC_INI_OPER"
                 ,"FEC_REG_F9", "FECHA", "FECHA_REGISTRO","FECHA_ULT_ACT_F12B", "FECHA_VIABILIDAD", "ULT_FEC_DECLA_ESTIM")
  
  NUMERICAS <- c( "ANIO", "ANIO_PROCESO", "AVANCE", "AVANCE_EJECUCION", "AVANCE_FISICO","BENEFICIARIO", "CERTIF_ANIO_ACTUAL"
                 ,"COMPROM_ANUAL_ANIO_ACTUAL","CONTRIBUCION", "COSTO_ACTUALIZADO", "CTRL_CONCURR", "DEV_ABR_ANIO_VIG"
                 ,"DEV_AGO_ANIO_VIG", "DEV_ANIO_ACTUAL", "DEV_DIC_ANIO_VIG", "DEV_ENE_ANIO_VIG","DEV_FEB_ANIO_VIG", "DEV_JUL_ANIO_VIG"
                 ,"DEV_JUN_ANIO_VIG", "DEV_MAR_ANIO_VIG","DEV_MAY_ANIO_VIG", "DEV_NOV_ANIO_VIG", "DEV_OCT_ANIO_VIG", "DEV_SET_ANIO_VIG"
                 ,"DEVEN_ACUMUL_ANIO_ANT", "DEVEN_ACUMULADO", "LATITUD", "LONGITUD","MONTO_ACTUALIZADO_FINANCIERO"
                 ,"MONTO_ACTUALIZADO_FISICO","MONTO_EJECUTADO_FISICO", "MONTO_FIANZA", "MONTO_LAUDO","MONTO_PROGRAMADO_FINANCIERO"
                 ,"MONTO_PROGRAMADO_FISICO", "MONTO_VALORIZACION","MONTO_VIABLE", "MTO_ET_F8", "NUM_HABITANTES_BENEF", "PIA_ANIO_ACTUAL"
                 ,"PIM_ANIO_ACTUAL", "PMI_ANIO_1", "PMI_ANIO_2", "PMI_ANIO_3", "PMI_ANIO_4","PRIMER_DEVENGADO", "PROG_ACTUAL_ANIO_ACTUAL"
                 , "SALDO_EJECUTAR", "VALOR","MONTO_ET_F8")
  
  ENTERAS   <- c("UBIGEO")
  
  SI_NO     <- c("CULMINADA", "EXPEDIENTE_TECNICO", "INFORME_CIERRE", "REGISTRADO_PMI","SANEAMIENTO", "TIENE_AVAN_FISICO", "TIENE_F12B", "TIENE_F8", "TIENE_F9")
  
  # Leer archivo
  df <- read.csv(
     link
    ,colClasses = 'character'
    ,header = TRUE
    ,na.strings = c('', ' ', '-', 'NULL', 'null', '--', '-.-')
    ,fileEncoding = 'utf-8') %>% 
    mutate(across(where(is.character), trimws)) 
  
  names(df) <- trimws(names(df))
  
  # Asignar tipos de variables
  for (col in names(df)) { 
         if (col %in% CADENAS)   { df[[col]] <- as.character(df[[col]]) } 
    else if (col %in% FECHAS)    { df[[col]] <- as.Date(df[[col]], format = "%Y-%m-%d") } 
    else if (col %in% ENTERAS)   { df[[col]] <- as.integer(df[[col]]) } 
    else if (col %in% NUMERICAS) { df[[col]] <- as.numeric(df[[col]]) } 
    else if (col %in% SI_NO)     { df[[col]] <- case_when( tolower(df[[col]]) %in% c('si', 'sí') ~ 1, tolower(df[[col]]) %in% c('no') ~ 0, TRUE ~ 0)}}
  
  # Guardar como Parquet si es necesario
  eval( parse(text = paste0("arrow::write_parquet(df,'",gsub("csv","parquet",sub(".*/", "",link)),"')") ) )
  return(df)
}

# Aplicar la función a cada elemento del vector ruta
lapply(ruta, import_file) 


# 09 Diccionario de datos
library(tidyverse)
library(rlang)

setwd( dirname(rstudioapi::getActiveDocumentContext()$path) )

fuente <- c('Cierre de inversiones'
            ,'Detalle inversiones'
            ,'Estado situacional de inversiones'
            ,'Formato 12B de inversiones'
            ,'Indicadores de Brechas'
            ,'Inversiones desactivadas'
            ,'Proceso de seleccion de inversiones')

ruta <- c('https://fs.datosabiertos.mef.gob.pe/datastorefiles/Cierre_Inversiones_Diccionario.csv'
          ,'https://fs.datosabiertos.mef.gob.pe/datastorefiles/Detalle_Inversiones_Diccionario.csv'
          ,'https://fs.datosabiertos.mef.gob.pe/datastorefiles/Estado_Situacional_Diccionario.csv'
          ,'https://fs.datosabiertos.mef.gob.pe/datastorefiles/F12B_Diccionario.csv'
          ,'https://fs.datosabiertos.mef.gob.pe/datastorefiles/Inversiones_Brechas_Diccionario.csv'
          ,'https://fs.datosabiertos.mef.gob.pe/datastorefiles/Inversiones_Desactivadas_Diccionario.csv'
          ,'https://fs.datosabiertos.mef.gob.pe/datastorefiles/Proceso_Selecccion_Diccionario.csv')

diccionario <- purrr::map2_df( ruta , fuente , ~{read_csv(.x) %>% mutate(Fuente=factor(.y)) } )

arrow::write_parquet( diccionario , 'DICCIONARIO.parquet' )

# MEF tipo de municipalidad - listado de municipalidades segun tipo -------------------------------------------------------
tipo_municipalidad <- rbind(
  # Tipo A
  expand.grid( UBIGEO = c( "010101","010201","010701","020101","020801","021101","021801","030101","030201","040101","040701"
                          ,"050101","050401","060101","060401","060601","060801","070101","080101","080601","080801","080901"
                          ,"090101","100101","100601","110101","110201","110301","110501","120101","120301","120401","120601"
                          ,"120701","120801","120901","130101","130401","130901","131201","140101","140201","140301","150101"
                          ,"150201","150501","150601","150801","160101","160201","160501","170101","180101","180301","190101"
                          ,"200101","200401","200501","200601","200701","200801","210101","210201","210501","210801","211101"
                          ,"220101","220601","220801","220901","230101","240101","240301","250101")
               ,TIPO_MUNICIPALIDAD = "A")
  # Tipo B
  ,expand.grid( UBIGEO = c( "010301","010401","010501","010601","020201","020301","020401","020501","020601","020701","020901"
                           ,"021001","021201","021301","021401","021501","021601","021701","021901","022001","030301","030401"
                           ,"030501","030601","030701","040201","040301","040401","040501","040601","040801","050201","050301"
                           ,"050501","050601","050701","050801","050901","051001","051101","060201","060301","060501","060701"
                           ,"060901","061001","061101","061201","061301","080201","080301","080401","080501","080701","081001"
                           ,"081101","081201","081301","090201","090301","090401","090501","090601","090701","100201","100301"
                           ,"100401","100501","100701","100801","100901","101001","101101","110401","120201","120501","130201"
                           ,"130301","130501","130601","130701","130801","131001","131101","150301","150401","150701","150901"
                           ,"151001","160301","160401","160601","160701","160801","170201","170301","180201","190201","190301"
                           ,"200201","200301","210301","210401","210601","210701","210901","211001","211201","211301","220201"
                           ,"220301","220401","220501","220701","221001","230201","230301","230401","240201","250201","250301"
                           ,"250401")
                , TIPO_MUNICIPALIDAD = "B")
  # Tipo C
  ,expand.grid( UBIGEO = c( "150102","150103","150104","150105","150106","150107","150108","150109","150110","150111","150112"
                           ,"150113","150114","150115","150116","150117","150118","150119","150120","150121","150122","150123"
                           ,"150124","150125","150126","150127","150128","150129","150130","150131","150132","150133","150134"
                           ,"150135","150136","150137","150138","150139","150140","150141","150142","150143")
                , TIPO_MUNICIPALIDAD = "C")
  # Tipo D
  ,expand.grid( UBIGEO = c( "020105","021803","021809","030109","030213","030216","040102","040103","040104","040105","040106"
                           ,"040107","040109","040110","040111","040112","040116","040117","040122","040123","040126","040128"
                           ,"040129","040520","050104","050110","050115","050116","060108","070102","070103","070104","070105"
                           ,"070106","070107","080104","080105","080106","080108","090118","100102","100111","100606","100608"
                           ,"110102","110103","110106","110108","110110","110112","110206","110207","110210","110305","110506"
                           ,"110507","110508","120107","120114","120117","120119","120121","120125","120129","120133","120134"
                           ,"120302","120303","120305","120430","120434","120606","120808","130102","130103","130104","130105"
                           ,"130106","130107","130109","130111","130205","130208","130702","130704","140105","140106","140108"
                           ,"140112","140118","140120","140206","150202","150204","150205","150507","150509","150605","150803"
                           ,"150805","150806","150810","160108","160112","160113","170103","180104","180302","180303","190109"
                           ,"190113","200104","200105","200109","200110","200114","200115","200602","211105","220804","220909"
                           ,"220910","230102","230104","230108","230110","240302","250105","250107")
                ,TIPO_MUNICIPALIDAD = "D")
  # Tipo E
  ,expand.grid( UBIGEO = c("010108","010110","010112","010113","010115","010118","010119","010303","010307","010309","010510"
                           ,"010516","010603","020502","020506","020507","020508","020509","020511","020512","020513","020514"
                           ,"020515","020803","020903","020905","020907","021010","021012","021403","021404","021406","021407"
                           ,"021408","021410","021507","021703","021705","021706","021806","021807","021808","030102","030211"
                           ,"030220","030302","030304","030305","030306","030307","030403","030411","030602","030709","030711"
                           ,"030712","030713","040108","040115","040118","040121","040124","040127","040202","040204","040205"
                           ,"040206","040208","040302","040303","040305","040307","040310","040311","040313","040402","040403"
                           ,"040407","040409","040410","040414","040502","040503","040505","040509","040510","040512","040513"
                           ,"040515","040518","040519","040702","040703","040704","040705","040706","040802","040809","050302"
                           ,"050503","050507","050602","050603","050604","050616","050620","050621","050702","050705","050804"
                           ,"050805","050810","050902","050905","050906","050907","050910","050911","051002","051003","051005"
                           ,"051006","051009","051010","051011","051102","060502","080207","080402","080910","081004","081008"
                           ,"081202","081203","081208","081211","081304","081307","090104","090107","090111","090303","090308"
                           ,"090605","090710","090713","100508","100604","101004","110105","110109","110111","110113","110202"
                           ,"110211","110304","110402","110505","120104","120116","120120","120122","120128","120130","120132"
                           ,"120136","120202","120208","120210","120212","120213","120215","120402","120404","120405","120407"
                           ,"120408","120409","120410","120412","120413","120414","120415","120418","120420","120421","120425"
                           ,"120428","120429","120432","120433","120502","120705","120708","120803","120805","120806","120810"
                           ,"120903","120905","120908","130202","130203","130204","130207","130306","130402","130403","130703"
                           ,"130705","131202","131203","140102","140103","140104","140107","140109","140110","140111","140113"
                           ,"140114","140115","140116","140117","140119","140311","150203","150302","150403","150404","150405"
                           ,"150406","150502","150504","150505","150508","150510","150512","150513","150514","150515","150602"
                           ,"150603","150604","150607","150608","150609","150612","150703","150704","150707","150708","150709"
                           ,"150712","150714","150718","150719","150720","150721","150722","150724","150725","150727","150728"
                           ,"150729","150730","150812","150902","150906","151004","151007","151010","151012","151013","151014"
                           ,"151017","151018","151021","151023","151025","151026","151027","151028","151029","151033","160510"
                           ,"160606","170104","170204","170302","180103","180105","180206","180208","190103","190104","190105"
                           ,"190107","190111","190112","190202","190203","190204","190205","190207","190307","200107","200108"
                           ,"200402","200405","200406","200502","200503","200504","200505","200506","200507","200603","200605"
                           ,"200606","200607","200608","200702","200703","200704","200705","200706","200802","200803","200805"
                           ,"200806","210306","210709","211002","211302","220102","220103","220105","220106","220205","220206"
                           ,"220406","220703","220704","220705","220706","220707","220803","220806","220808","220809","220903"
                           ,"220905","220906","220908","220912","220913","220914","230109","230202","230203","230204","230205"
                           ,"230206","230302","230403","230404","230405","230406","230407","230408","240102","240103","240105"
                           ,"240106","240203","240303","250305")
                ,TIPO_MUNICIPALIDAD = "E")
  # Tipo F
  ,expand.grid( UBIGEO = c("010102","010104","010107","010109","010111","010116","010121","010203","010204","010206","010302"
                           ,"010305","010306","010310","010312","010502","010504","010505","010506","010508","010509","010511"
                           ,"010512","010517","010522","010523","010606","010607","010608","010703","010704","010706","020103"
                           ,"020106","020108","020203","020205","020302","020304","020504","020505","020602","020603","020606"
                           ,"020607","020610","020802","020804","020902","020904","020906","021005","021006","021007","021008"
                           ,"021009","021013","021015","021016","021103","021104","021105","021202","021205","021402","021409"
                           ,"021503","021504","021505","021506","021508","021509","021511","021702","021704","021707","021709"
                           ,"021710","021805","021902","021903","021905","021910","022003","022006","030104","030106","030203"
                           ,"030204","030206","030212","030214","030215","030219","030303","030402","030404","030405","030410"
                           ,"030412","030417","030502","030504","030506","030604","030607","030610","030705","030706","030707"
                           ,"030708","030710","030714","040113","040114","040119","040125","040308","040312","040404","040405"
                           ,"040406","040408","040412","040413","040504","040506","040507","040508","040511","040514","040517"
                           ,"040604","040605","040606","040607","040803","040804","040805","040806","040808","040810","040811"
                           ,"050105","050107","050108","050111","050202","050203","050206","050303","050304","050402","050403"
                           ,"050405","050407","050408","050409","050412","050508","050509","050605","050606","050608","050609"
                           ,"050610","050611","050612","050614","050615","050617","050618","050619","050704","050706","050707"
                           ,"050802","050803","050806","050807","050809","050903","050904","050908","051007","051008","051103"
                           ,"051105","051106","051108","060305","060411","060414","060507","060508","060802","060808","061003"
                           ,"061102","061309","080103","080107","080202","080203","080204","080205","080206","080302","080303")
                ,TIPO_MUNICIPALIDAD = "F")
  ,expand.grid( UBIGEO = c("080305","080307","080308","080309","080403","080404","080405","080407","080506","080602","080603"
                           ,"080605","080606","080607","080608","080708","080802","080805","080903","080907","080912","081002"
                           ,"081005","081007","081106","081207","081302","081303","090106","090108","090109","090112","090115"
                           ,"090204","090205","090206","090207","090208","090304","090307","090309","090403","090408","090412"
                           ,"090413","090505","090508","090509","090602","090604","090608","090614","090616","090706","090711"
                           ,"090721","090722","090723","100105","100112","100202","100206","100208","100307","100311","100313"
                           ,"100316","100317","100323","100503","100506","100507","100605","100702","100704","100705","100802"
                           ,"100803","101002","101006","101102","110104","110107","110204","110205","110302","110303","110403"
                           ,"110404","110405","110503","110504","120105","120106","120108","120111","120112","120113","120126"
                           ,"120127","120211","120214","120304","120403","120416","120422","120424","120426","120427","120431"
                           ,"120503","120604","120702","120703","120704","120706","120707","120802","120804","120807","120809"
                           ,"120902","120904","120906","120907","130206","130304","130305","130605","130805","130808","130811"
                           ,"131002","131003","131004","131006","140204","140205","140303","140304","140305","140307","140309"
                           ,"140312","150304","150305","150402","150407","150503","150506","150511","150516","150606","150610"
                           ,"150611","150705","150710","150711","150715","150717","150732","150804","150808","150809","150811"
                           ,"150903","151003","151006","151008","151011","151015","151016","151020","151022","151024","151030"
                           ,"151031","151032","160103","160104","160106","160205","160206","160211","160502","160503","160504"
                           ,"160506","160509","160511","160602","160603","160605","160704","160705","160802","170102","170203"
                           ,"170303","180102","180106","180202","180203","180207","180209","180210","180211","190102","190106"
                           ,"190108","190110","190208","190302","190303","190306","190308","200111","200209","200404","200407"
                           ,"200408","200804","210109","210111","210207","210209","210211","210212","210302","210304","210305"
                           ,"210308","210310","210402","210602","210603","210706","210707","210708","210710","210802","210804"
                           ,"210805","210806","210808","210903","211004","211103","211202","211203","211207","211208","211304"
                           ,"211306","211307","220104","220202","220204","220302","220305","220402","220403","220404","220405"
                           ,"220502","220503","220504","220505","220507","220508","220509","220510","220511","220603","220604"
                           ,"220702","220709","220710","220802","220805","220807","220902","220904","220907","220911","221002"
                           ,"221005","230103","230105","230106","230303","230402","240104","240304","250102","250106","250202"
                           ,"250302","250303","250304")
                ,TIPO_MUNICIPALIDAD = "F")
  # Tipo G
  ,expand.grid( UBIGEO = c("010103","010105","010106","010114","010117","010120","010202","010205","010304","010308","010311"
                           ,"010402","010403","010503","010507","010513","010514","010515","010518","010519","010520","010521"
                           ,"010602","010604","010605","010609","010610","010611","010612","010702","010705","010707","020102"
                           ,"020104","020107","020109","020110","020111","020112","020202","020204","020303","020305","020306"
                           ,"020402","020503","020510","020604","020605","020608","020609","020611","020702","020703","021002"
                           ,"021003","021004","021011","021014","021102","021203","021204","021206","021207","021208","021209"
                           ,"021210","021302","021303","021304","021305","021306","021307","021308","021405","021502","021510"
                           ,"021602","021603","021604","021708","021802","021804","021904","021906","021907","021908","021909"
                           ,"022002","022004","022005","022007","022008","030103","030105","030107","030108","030202","030205"
                           ,"030207","030208","030209","030210","030217","030218","030406","030407","030408","030409","030413"
                           ,"030414","030415","030416","030503","030505","030603","030605","030606","030608","030609","030611"
                           ,"030612","030702","030703","030704","040120","040203","040207","040304","040306","040309","040411"
                           ,"040516","040602","040603","040608","040807","050102","050103","050106","050109","050112","050113"
                           ,"050114","050204","050205","050404","050406","050410","050411","050413","050502","050504","050505"
                           ,"050506","050510","050511","050512","050513","050514","050515","050607","050613","050703","050708"
                           ,"050808","050909","051004","051012","051104","051107","060102","060103","060104","060105","060106"
                           ,"060107","060109","060110","060111","060112","060202","060203","060204","060302","060303","060304"
                           ,"060306","060307","060308","060309","060310","060311","060312","060402","060403","060404","060405"
                           ,"060406","060407","060408","060409","060410","060412","060413","060415","060416","060417","060418"
                           ,"060419","060503","060504","060505","060506","060602","060603","060604","060605","060606","060607"
                           ,"060608","060609","060610","060611","060612","060613","060614","060615","060702","060703","060803"
                           ,"060804","060805","060806","060807","060809","060810")
                ,TIPO_MUNICIPALIDAD = "G")
  ,expand.grid( UBIGEO = c("060811","060812","060902","060903","060904","060905","060906","060907","061002","061004","061005"
                           ,"061006","061007","061103","061104","061105","061106","061107","061108","061109","061110","061111"
                           ,"061112","061113","061202","061203","061204","061302","061303","061304","061305","061306","061307"
                           ,"061308","061310","061311","080102","080304","080306","080406","080408","080502","080503","080504"
                           ,"080505","080507","080508","080604","080702","080703","080704","080705","080706","080707","080803"
                           ,"080804","080806","080807","080808","080902","080904","080905","080906","080908","080909","080911"
                           ,"080913","080914","080915","080916","080917","080918","081003","081006","081009","081102","081103"
                           ,"081104","081105","081204","081205","081206","081209","081210","081212","081305","081306","090102"
                           ,"090103","090105","090110","090113","090114","090116","090117","090119","090202","090203","090302"
                           ,"090305","090306","090310","090311","090312","090402","090404","090405","090406","090407","090409"
                           ,"090410","090411","090502","090503","090504","090506","090507","090510","090511","090603","090606"
                           ,"090607","090609","090610","090611","090612","090613","090615","090702","090703","090704","090705"
                           ,"090707","090709","090714","090715","090716","090717","090718","090719","090720","090724","090725"
                           ,"100103","100104","100106","100107","100108","100109","100110","100113","100203","100204","100205"
                           ,"100207","100321","100322","100402","100403","100404","100502","100504","100505","100509","100510"
                           ,"100511","100602","100603","100607","100609","100610","100703","100804","100902","100903","100904"
                           ,"100905","101003","101005","101007","101103","101104","101105","101106","101107","101108","110114"
                           ,"110203","110208","110209","110502","120124","120135","120203","120204","120205","120206","120207"
                           ,"120209","120306","120406","120411","120417","120419","120423","120504","120602","120603","120605"
                           ,"120607","120608","120609","120709","120909","130108","130110","130112","130302","130303","130502"
                           ,"130503","130504","130602","130604","130606","130608","130610","130611","130613","130614","130802"
                           ,"130803","130804","130806","130807","130809","130810","130812","130813","130902","130903","130904"
                           ,"130905","130906","130907","130908","131005","131007","131008","131102","131103","131104","140202"
                           ,"140203","140302","140306","140308","140310","150303","150702","150706","150713","150716","150723"
                           ,"150726","150731","150802","150807","150904","150905","151002","151005","151009","151019","160102"
                           ,"160105","160107","160110","160202","160210","160302","160303","160304","160305","160402","160403"
                           ,"160404","160505","160507","160508","160604","160702","160703","160706","160803","160804","170202"
                           ,"180107","180204","180205","190206","190304","190305","200202","200203","200204","200205","200206"
                           ,"200207","200208","200210","200302","200303","200304","200305","200306","200307","200308","200403"
                           ,"200409","200410","200604","210102","210103","210104","210105","210106","210107","210108","210110"
                           ,"210112","210113","210114","210115","210202","210203","210204","210205","210206","210208","210210"
                           ,"210213","210214","210215","210303","210307","210309","210403","210404","210405","210406","210407"
                           ,"210502","210503","210504","210505","210604","210605","210606","210607","210608","210702","210703"
                           ,"210704","210705","210803","210807","210809","210902","210904","211003","211005","211102","211104"
                           ,"211204","211205","211206","211209","211210","211303","211305","220203","220303","220304","220506"
                           ,"220602","220605","220708","221003","221004","221006","230107","230111","240202","250103","250104"
                           ,"250203","250204","250306","250307")
                ,TIPO_MUNICIPALIDAD = "G"))

arrow::write_parquet( tipo_municipalidad , 'TIPO_MUNICIPALIDAD.parquet' )

    
